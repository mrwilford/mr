const mrExecutionBegin=new Date;function mrCreate(e){"use strict";if(e||(e={}),!luxon)throw new Error("Missing dependency: luxon");const t="mr.js Â© "+luxon.DateTime.fromJSDate(mrExecutionBegin).year+" Michael Wilford. All Rights Reserved.",r=(...e)=>Object.freeze(Object.assign({},...e.map((e=>Object.freeze(g.obj(e)?{[D(Object.keys(e))]:D(Object.values(e))}:{[e]:e}))))),n=function(e){return ne.RELEASE==ae||(n.useConsole&&console[l?l.func:"log"](e),n.useLogger&&Logger.log((l?l.desc:"")+e),l=null),e};n.info=e=>n(e,l=s),n.warn=e=>n(e,l=a),n.error=n.err=e=>n(e,l=i);const i={func:"error",desc:"âŒ ERROR: "},a={func:"warn",desc:"ðŸš§ WARN: "},s={func:"info",desc:"ðŸŒ INFO: "};let l=null;const o=function(e=null,t){return e||(g.func(t)?t(e):u(e,t))},u=(e,t)=>{const r=h()[2],n=" ["+r.func+" ("+r.file+":"+r.line+")]";throw new Error("âŒ ASSERT FAILED"+(g.def(t)?": "+t:"")+n)},c=e=>{if(Utilities&&g.func(Utilities.sleep))return Utilities.sleep(e);o()},d=(e,{tries:t=1,wait:r=mr.secToMs(1),check:i,onFail:a=f}={})=>{for(let s=1;;++s)try{return e(s)}catch(e){if(t<=s||g.func(i)&&!i(e,s))return g.func(a)&&a(e,s);n.warn("mr.retry: attempt number "+s+" of "+t+" has failed:\n"+e.message),c(r)}},f=e=>{throw e},m=(e,t,r)=>{if(!t){const e=h()[1];t=e.func+" ("+e.file+":"+e.line+")"}p.push(t);const i=p.reduce(((e,t,r)=>e+" Â» "+t),""),a=luxon.DateTime.local(),s=e.call(r);return p.pop(),n.info("â± PROFILE: "+K({start:a}).as("ms")+"ms to complete"+i),s},p=[],h=()=>{try{throw new Error("ðŸ”¥")}catch(e){const t=e.stack.replace(/^.*ðŸ”¥\n/,"").replace(/\n\s+at __GS_INTERNAL_top_function_call__.gs:1:8/,"");let r=t.split(/\s*at /g);return r.shift(),r.shift(),r=r.map((e=>({func:j(e.match(/(.*)\s+/))||"",file:j(e.match(/\((.*?)[:)]/))||"",line:j(e.match(/:(.*):/))||"",column:j(e.match(/\d+:(.*)\)$/))||""}))),r.display=t,r}},g=function(e){return g.null(e)?null:g.nan(e)?NaN:g.inf(e)?1/0:g.num(e)?I:g.bool(e)?P:g.str(e)?_:g.arr(e)?B:g.func(e)?G:g.err(e)?err:g.date(e)?Z:g.dt(e)?dt:g.dur(e)?dur:g.interval(e)?interval:g.ss(e)?te.drive.ss:g.sheet(e)?te.drive.sheet:g.form(e)?te.drive.form:g.doc(e)?te.drive.doc:g.slide(e)?te.drive.slide:g.site(e)?te.drive.site:g.page(e)?te.drive.page:g.file(e)?te.drive.file:g.folder(e)?te.drive.folder:g.obj(e)?H:void o(g.undef(e))};g.undefined=g.undef=e=>void 0===e,g.defined=g.def=e=>!g.undefined(e),g.null=e=>null===e,g.undefNull=e=>null==e,g.primitive=g.prim=e=>e!==Object(e),g.boolean=g.bool=e=>"boolean"==typeof e||e instanceof Boolean,g.nan=g.NaN=e=>g.num(e)&&Number(e)!=Number(e),g.finite=g.fin=e=>g.num(e)&&isFinite(e),g.infinity=g.inf=e=>1/0===e,g.number=g.num=e=>"number"==typeof e||e instanceof Number,g.string=g.str=e=>"string"==typeof e||e instanceof String,g.array=g.arr=e=>!(!e||"object"!=typeof e||e.constructor!==Array),g.function=g.func=e=>!(!e||"[object Function]"!={}.toString.call(e)),g.iterator=e=>g.obj(e)&&g.func(e.next),g.object=g.obj=e=>!(!e||"object"!=typeof e||e.constructor!==Object),g.error=g.err=e=>!(!e||!e.message),g.date=g.Date=e=>!(!e||"[object Date]"!={}.toString.call(e)),g.datetime=g.dt=e=>e instanceof luxon.DateTime,g.duration=g.dur=e=>e instanceof luxon.Duration,g.interval=e=>e instanceof luxon.Interval,g.column=g.col=e=>e instanceof Q,g.spreadsheet=g.ss=e=>"Spreadsheet"==g.drive(e).name,g.sheet=e=>g.obj(e)&&g.func(e.getParent)&&g.ss(e.getParent()),g.form=e=>"Form"==g.drive(e).name,g.document=g.doc=e=>"Document"==g.drive(e).name,g.presentation=g.slide=e=>"Presentation"==g.drive(e).name,g.site=e=>"Site"==g.drive(e).name,g.page=e=>g.obj(e)&&g.func(e.getParent)&&g.site(e.getParent()),g.folder=e=>"Folder"==g.drive(e).name,g.file=e=>"File"==g.drive(e).name,g.drive=t=>{let r,n,i;try{return(t.mr||t).getName("INTENTIONALLY INCORRECT PARAMETER"),{}}catch(e){i=e.message;try{[n,r]=i.match(/signature for (.*App)\.(.*)\.getName/).slice(1)}catch(e){return{}}}o(r&&r.length&&g.func(t.getId),"Could not get type name from: "+i);const a=o("Folder"==r?MimeType.FOLDER:("File"==r?t:DriveApp.getFileById(t.getId())).getMimeType()),s=o(e[n]),l=[{name:"SpreadsheetApp",app:SpreadsheetApp,mime:MimeType.GOOGLE_SHEETS},{name:"DocumentApp",app:DocumentApp,mime:MimeType.GOOGLE_DOCS},{name:"FormApp",app:FormApp,mime:MimeType.GOOGLE_FORMS},{name:"SlidesApp",app:SlidesApp,mime:MimeType.GOOGLE_SLIDES},{name:"SitesApp",app:SitesApp,mime:MimeType.GOOGLE_SITES}].filter((e=>e.mime===a)),u=l.length?D(l):{app:null};return{name:r,mime:a,creator:s,factory:u}},g.object.empty=e=>!Object.getOwnPropertyNames(e).length,g.string.blank=e=>g.str(e)&&!e.trim().length,g.string.id=e=>g.str(e)&&44==e.length&&/[A-Z0-9-_]/gi.test(e),g.string.mailto=e=>g.str(e)&&e.startsWith("mailto:"),g.string.url=e=>g.str(e)&&/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e);const v=(e,t)=>[t,e],b=(e,t,{thisArg:r,initial:n}={})=>{const i=g.def(n),a=g.obj(e)&&!g.fin(e.length)&&!g.iterator(e),s=a?Object.entries(e):B(e);let l=i?n:[];e:for(let e=0;e<s.length;++e){const n=a?s[e][0]:e,o=a?s[e][1]:s[e],u={elem:o,value:o,element:o,key:n,index:n,valueOf:()=>n,array:s,accum:l};try{const e=t.call(r,u);if(i)l=e;else if(a)l.push([n,e]);else{const t={elem:e,value:e,element:e,key:n,index:n,valueOf:()=>n,array:s,accum:l};l.push(t)}}catch(e){if(e===y)continue e;if(e===F)break;throw e}}return i||(a?l=Object.fromEntries(l):(H.def(l,["elems","values","elements"],{get:()=>l.map((e=>e.elem))}),H.def(l,["keys","indexes","indices"],{get:()=>l.map((e=>e.key))}))),l},F={},y={};Object.defineProperties(b,{continue:{get:()=>{throw y},set:()=>o()},break:{get:()=>{throw F},set:()=>o()}});const O=(e,t=1,r=E)=>{const n=g.obj(e)?Object.values(e):B(e);return o(t===n.length,r),e},E=e=>{throw new Error("Unexpected length: "+e)},D=(e,t=E)=>{const r=g.obj(e)?Object.values(e):B(e);return O(e,1,t),r[0]},j=e=>{const t=B(e);return t[t.length-1]},T=(e,t=1,r)=>{const n=g.obj(e),i=n?Object.entries(e):B(e);o(t<=i.length);const a=b(B.new(t),(e=>rng(R(r,{int:!0,min:0,max:i.length,exclude:e.accum})))).elems;return n?b(a,(e=>i[+e][0])).elems:a},w=(e,t)=>{const r=g.obj(e),n=r?Object.entries(e):B(e),i=R(t,{int:!0,max:n.length});return b(n,(e=>{n.length;const t=rng(R(i,{min:+e}));r?[n[+e][1],n[t][1]]=v(n[+e][1],n[t][1]):[n[+e],n[t]]=v(n[+e],n[t])})).elems,r?Object.fromEntries(n):n},A=(e,t)=>{o(g(e)===g(t));const r=g.obj(e),n=r?Object.values(e):B(e),i=r?Object.values(t):B(t);return[].concat(...n.map((e=>i.map((t=>[].concat(e,t))))))},S=(e,t,...r)=>t?S(A(e,t),...r):e,x=e=>{if(g.prim(e))return e;if(g.date(e)||g.dt(e)){let t=new Date;return t.setTime(e.getTime()),g.dt(e)?luxon.DateTime.fromJSDate(t):t}return g.arr(e)?b(e,(e=>x(e.elem))).elems:(o(g.obj(e)),Object.fromEntries(x(Object.entries(e))))},N=e=>g.obj(e)?(Object.getOwnPropertyNames(e).forEach((t=>delete e[t])),e):g.arr(e)?(e.length=0,e):[],R=(e,t)=>{if(o(g(e)===g(t),'"'+g(e)+'" =!= "'+g(t)+'"'),g.obj(e))return J.extend({},t,e);const r=B(e),n=B(t);return r.concat(n.filter((e=>0>r.indexOf(e))))},C=(e,t)=>{if(o(g(e)===g(t),'"'+g(e)+'" =!= "'+g(t)+'"'),g.obj(e))return Object.fromEntries(Object.entries(e).filter((([e,r])=>Object.entries(t).reduce(((t,[r,n])=>t+(e==r)),0))));const r=B(e),n=B(t);return r.filter((e=>0<=n.indexOf(e)))},L=(e,t)=>{if(o(g(e)===g(t),'"'+g(e)+'" =!= "'+g(t)+'"'),g.obj(e))return Object.fromEntries(Object.entries(e).filter((([e,r])=>!Object.entries(t).reduce(((t,[r,n])=>t+(e==r)),0))));const r=B(e),n=B(t);return r.filter((e=>0>n.indexOf(e)))},P=(e,{trueStrings:t=k,isCaseSensitive:r=!1}={})=>{const n=g.str(e)?(r?e:e.toLowerCase()).trim():e;if(t.filter((e=>n==(r?e.trim():e.trim().toLowerCase()))).length)return!0;const i=U(e);return!(!i||1!=i.length)&&!!(1*i[0])},k=["true","yes","on","âœ”","â˜‘","âœ…","ðŸ‘"],I=e=>D(U(e)),U=e=>g.fin(e)?[1*e]:g.str(e)?(e.match(/(\d+\.|\d+)+/g)||[]).map((e=>1*e)):g.obj(e)?Object.keys(e).reduce(((t,r)=>t.concat(U(e[r]))),[]):g.arr(e)?e.reduce(((e,t)=>e.concat(U(t))),[]):[];{I.clamp=(e,t=0,r=1)=>r<e?r:e<t?t:e,I.toString=(e,{commas:t=!0,decimals:r=0}={})=>{const n=e.toFixed(r).toString();return t?n.replace(/\B(?=(\d{3})+(?!\d))/g,","):n},I.distribution=I.dist={},I.dist.normal=I.dist.norm=I.dist.gaussian=I.dist.bell=function(e,t,r,n=I.dist.boxMuller){return n.apply(null,arguments)},I.dist.boxMuller=(e=I.rng({int:!0}),t=0,r=1)=>{o(0<=e&&e<=1),e=I.clamp(e,Number.MIN_VALUE,1-Number.EPSILON);const n=I.rng({min:Number.MIN_VALUE,max:1});return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*n)*r+t},I.rng=function({impl:e=I.rng.wichmannHill}={}){return e.apply(null,arguments)},Object.defineProperties(I.rng,{seed:{get:()=>e,set:(r=I.rng.defaultSeed)=>(t=null,e=r)},defaultSeed:{get:()=>5150,set:()=>o()}});let e=I.rng.defaultSeed;I.rng.wichmannHill=function({int:e=0,min:r=0,max:n=r+1+99*e,exclude:i=[]}={}){if(o(r<n&&(e&&g.arr(i)||!e&&(!i||!i.length))),!t){let e=I.rng.seed;t={x:0,y:0,z:0},t.x=e%30268+1,e=(e-e%30268)/30268,t.y=e%30306+1,e=(e-e%30306)/30306,t.z=e%30322+1,e=(e-e%30322)/30322}if(e){r=Math.floor(r),n=Math.ceil(n);const e=L(Array(n-r).fill(0).map(((e,t)=>r+t)),i);return o(e.length,"rng.int: no valid options between "+r+" and "+n),e[Math.floor(I.rng.wichmannHill()*e.length)]}t.x=171*t.x%30269,t.y=172*t.y%30307,t.z=170*t.z%30323;const a=(t.x/30269+t.y/30307+t.z/30323)%1;return r+a*(n-r)};let t=null}const _=e=>g.str(e)?e:e&&g.func(e.toString)?e.toString():JSON.stringify(e),z=_;{_.left=(e,t=1)=>_(e).substring(0,t<0?e.length+t:t),_.right=(e,t=-1)=>_(e).substring(t<0?e.length+t:t),_.mid=(e,t,r=1)=>{const n=_(e),i=t<0?n.length+t:t;return n.substring(i,i+r)},_.insert=_.inject=(e,t,r=0)=>{const n=_(e),i=r<0?n.length+r:r;return[n.slice(0,i),t,n.slice(i)].join("")},_.lower=_.lowercase=e=>_(e).toLowerCase(),_.upper=_.UPPERCASE=e=>_(e).toUpperCase(),_.title=_["Title Case"]=e=>_(e).toLowerCase().replace(/[_-]/g," ").replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toUpperCase())),_.camel=_.camelCase=e=>_(e).toLowerCase().replace(/[_-]/g," ").replace(/[^a-zA-Z0-9 ]/g,"").replace(/(?:^\w|[A-Z]|\b\w)/g,((e,t)=>t?e.toUpperCase():e.toLowerCase())).replace(/\s+/g,""),_.pascal=_.PascalCase=e=>_(e).toLowerCase().replace(/[_-]/g," ").replace(/[^a-zA-Z0-9 ]/g,"").replace(/(?:^\w|[A-Z]|\b\w)/g,(e=>e.toUpperCase())).replace(/\s+/g,""),_.snake=_.snake_case=e=>_(e).toLowerCase().replace(/[_-]/g," ").replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g,"_"),_.kebab=_["kebab-case"]=e=>_(e).toLowerCase().replace(/[_-]/g," ").replace(/[^a-zA-Z0-9 ]/g,"").replace(/\s+/g,"-"),_.hash=e=>_(e).split("").reduce(((e,t)=>(e=(e<<5)-e+t.charCodeAt(0))&e),0),_.nonblank=e=>!!_(e).replace(/\s/g,"").length,_.count=_.has=(e,t,r=!1)=>{const n=_(e);if(!t.length)return n.length+1;const i=r?1:t.length;for(let e=0,r=0;;++e,r+=i)if(r=n.indexOf(t,r),r<0)return e},_.findClosing=(t,r=0,n=!1,i=e)=>{const a=_(t),s=r<0?a.length+r:r;if(n){const e=_.mid(a,s,_.findClosing(a,s)-s+1),t=_.insert(e,"/",1);return a.indexOf(t,s)}const l=a[s],u=i[l];o(u,"No matching brace found for: "+l);for(let e=s+1,t=1;e<a.length;++e)if(l===a[e])++t;else if(u===a[e]&&0==--t)return e;return-1};const e={"(":")","[":"]","{":"}","<":">","â€¹":"â€º","Â«":"Â»","â€¹":"â€º","â½":"â¾","â…":"â†","â€œ":"â€","â€˜":"â€™","ã€Œ":"ã€","ã€Ž":"ã€","ã€Š":"ã€‹","ã€ˆ":"ã€‰"}}_.urlToId=e=>e.match(/[-\w]{25,}/)[0];const G=e=>g.function(e)?e:function(){return e},B=(...e)=>{if(!e.length)return;if(1<e.length)return e;if(e=e[0],g.arr(e))return e;if(g.prim(e))return[e];if(g.def(e.length))return Array.from(e);if(!g.func(e.next))return Object.values(e);let t=1024,r=[];for(;e.hasNext()&&--t;)r.push(e.next());return o(t),r},q=B;{B.new=(t,r=e)=>{let n=Array(t).fill(g.func(initialValue)?null:initialValue);return g.func(initialValue)&&(n=n.map(r)),n};const e=(e,t)=>t;B.unique=e=>new Set([...e]),B.set=(e,t,r)=>(t<e.length-1&&(e.length=Math.max(t+1,e.length)),e[t]=r,e),B.match=(e,t,r,n=!0)=>{console.log("match("+JSON.stringify(e)+","+JSON.stringify(t)+","+JSON.stringify(r)+")");const i=B(r).map((r=>{const i=b(t,(t=>t.elem===r?e[+t]:b.continue)).elems;return n?i.uno:i}));return g.arr(r)?i:D(i)},B.transpose=e=>B(e[0]).map(((t,r)=>e.map(((t,n)=>B(e[n])[r])))),B.matrixMultiply=B.multiply=B.mmult=(e,t)=>e.map(((r,n)=>B(t[0]).map(((r,i)=>B(e[0]).reduce(((r,a,s)=>r+B(e[n])[s]*B(t[s])[i]),0)))))}const J=(...e)=>g.obj(e[0])?1===e.length?e[0]:Object.assign({},...e):d((()=>(o(!g.prim(e[0])),Object.assign({},...e.map((e=>Object.fromEntries(e)))))),{onFail:()=>Object.fromEntries([...e.map(((e,t)=>[t,e])).concat(e.length?[["length",e.length]]:[])])}),H=J;J.define=J.def=(e,t,r)=>(B(t).forEach((t=>Object.defineProperty(e,t,Object.assign({configurable:!0},r)))),e),J.extend=J.combine=J.merge=J.assign=function(e,...t){t.forEach((function(t){return H.keys(t,{nonenumerable:!0}).forEach((function(r){return Object.defineProperty(e,r,{configurable:!0,value:t[r]})}))}))},J.parents=J.prototypeChain=e=>e?[e,...J.parents(Object.getPrototypeOf(e))]:[],J.keys=J.propertyNames=(e,{inherited:t=!1,nonenumerable:r=!1}={})=>(t?H.parents(e):[e]).map((e=>Object[r?"getOwnPropertyNames":"keys"](e))).flat(),J.cacheable=(e,t,r)=>(o(t&&r),(t=B(t)).forEach((e=>e==z.upper(e)&&t.push(z.camel(e)))),t.forEach((t=>{const n=z(t),i="get"+n[0].toUpperCase()+n.slice(1);Object.defineProperty(e,i,{configurable:!0,value:function(){const t=r.apply(e,arguments);return Object.defineProperty(e,n,{configurable:!0,value:t}),t}}),Object.defineProperty(e,n,{configurable:!0,set:()=>o(),get:()=>e[i].apply(e)})})),e),J.cacheables=e=>(J.keys(e,{nonenumerable:!0}).forEach((t=>{if(!t.startsWith("get"))return;if(0<e[t].length)return;const r=t[3].toLowerCase()+t.slice(4);e.mr||(e.mr={}),e.mr[t]=e[t],J.cacheable(e,r,e.mr[t])})),e);const Z=(e,t,r)=>{o(!t&&!r||g.str(e));let n=(()=>{if(g.dt(e))return e;if(g.date(e))return luxon.DateTime.fromJSDate(e);if(g.str(e)&&g.str(t))return luxon.DateTime.fromString(e,t,r);if(g.str(e))return luxon.DateTime.fromISO(e);if(g.undef(e))return luxon.DateTime.local();o(g.finite(e));var n=Math.floor(e),i=e-n,a=Math.round(24*i*60*60*1e3),s=new Date(Date.UTC(1899,11,30+n)+a);return s.setMinutes(s.getMinutes()+s.getTimezoneOffset()),luxon.DateTime.fromJSDate(s)})();return n.serial=V,n},V=(e=new Date)=>(g.dt(e)&&(e=e.toJSDate()),((e.getTime()-W.getTime())/6e4-e.getTimezoneOffset())/1440),W=new Date(Date.UTC(1899,11,30,0,0,0,0));J.cacheable(luxon.DateTime,["serial","serialNumber","serialNum"],(function(){return V(this.toJSDate())}));const K=({start:e,end:t,name:r}={})=>{const n=luxon.DateTime.local();let i=e||Y[r]||se.time,a=t||n;r&&(Y[r]=n),o(i<=a,"Duration: Start ("+i.toFormat("h:mm:ss.S")+") is bigger than End ("+a.toFormat("h:mm:ss.S")+")!");const s=()=>{const e=luxon.Interval.fromDateTimes(i,a).toDuration();return Object.defineProperties(e,{start:{enumerable:!0,get:()=>i,set:e=>(o(g.dt(e)),i=e,s(),e)},end:{enumerable:!0,get:()=>a,set:e=>(o(g.dt(e)),a=e,s(),e)}}),e};return s()};let Y={};const Q=({number:e,letter:t,heading:r}={})=>{},X=function(e){const t={},r="A".charCodeAt(0);if(g.obj(e)&&(e=e.letter||e.number),g.num(e)){for(o(0<e,"colToLetter: Invalid column number"),t.number=e;0<e;){const n=(e-1)%26;t.letter=String.fromCharCode(n+r)+(t.letter||""),e=(e-n-1)/26}t.valueOf=()=>t.letter}else{o(g.str(e)),t.letter=e,t.number=0;for(let n=0;n<e.length;++n)t.number+=(e.charCodeAt(n)-(r-1))*Math.pow(26,e.length-n-1);t.valueOf=()=>t.number}return t},ee="undefined"!=typeof window,te=ee?void 0:{},re=ee?{}:void 0;if(ee)o($&&document&&M),re.get=e=>[...document.querySelectorAll(e)],re.init=()=>{M.AutoInit(),re.get(".collapsible.expandable").forEach((e=>M.Collapsible.init(e[0],{accordion:!1})));const e=re.get("*").map((e=>({id:e.id,count:0})));re.get("*").forEach((t=>{e.filter((e=>e.id===t.id)).uno})),re.get("*").forEach((e=>e.getAttribute("data-mr")))},re.goto=function(e,t){var r=re.get("main").uno,i=re.get("#"+t.attr("href").replace(/\#/g,""));if(!i.length)return n("goto href not found: "+t.attr("href"),"warn");var a=i.parents("ul"),s=i.parents("li"),l=0<=(s.attr("class")||"").indexOf("active"),o=i.parents("div[id*='tab']"),u=0<=(o.attr("class")||"").indexOf("active"),c=0<=(i.attr("class")||"").indexOf("collapsible-header");a.length&&!c&&M.Collapsible.getInstance(a).open(s.index()),u&&l?r.animate({scrollTop:0},500):setTimeout((function(){var e=i.offset().top-o.offset().top+20;r.animate({scrollTop:e},200)}),400)},re.getProps=function(e){re.get("#"+e).innerHTML="Getting properties...",run({req:"propAll",success:function(t){var r=(t=Object.keys(t).sort((function(e,t){return e<t?-1:1})).map((function(e){return{prop:e,type:t[e].type,value:t[e].value}}))).reduce((function(t,r){r.value.replace(/</g,"&lt;").replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;");return t+"<div><code>["+r.type+']</code><a href="##" class="link small" onclick=\'run({    req:"editProp_'+r.type+'",    args:"'+r.prop+'",    success:function(v){if(v)client.getProps("'+e+"\")}})'> "+r.prop+" </a></div>"}),"");re.get("#"+e).innerHTML=r}})},re.showEditURL=function(e){run({req:e,success:function(e){isString(e)&&e.length&&run({req:"showURL",args:e.replace("viewform","edit")})}})},re.iframeLaunch=function(e){run({req:e.getUrl,args:e.args,success:function(t){isString(t)&&t.length&&(re.get("#"+e.target).innerHTML='<iframe width="1" height="1" src="'+t+'"></iframe>')}})},re.toggle=function(e){var t=function(r){r.forEach((r=>{r.children.forEach((r=>{t(r),r.disabled=!e.value}))}))};t(re.get("#"+e.id))},re.simulateReg=function(e,t){run({req:"simulateRegs",args:e,success:function(e){re.get("#txtTestNumRegs").value=1,M.updateTextFields()}})},re.checkRegForm=function(e,t){const r=re.get("#spnStatusRegForm");r.innerHTML=statusErr+"Out of date",r.className="error"},document.addEventListener("DOMContentLoaded",re.init);else{o(DriveApp&&Sheets&&te);let e=[],t={};const i=(e,t,r=i.formula.mode,n="ROWS")=>{o(g.str(e)&&e.length),D(b(H.keys(i),(e=>i[e.elem].mode===r?e:b.continue)));try{return m((()=>d((()=>Sheets.Spreadsheets.Values.batchGet(e,{ranges:t,majorDimension:n,valueRenderOption:r,dateTimeRenderOption:"SERIAL_NUMBER"})))),"batchGet")}catch(e){let r=e.message;throw r.has("Response Code: 413")&&(r="batchGet: Request Entity Too Large"),r+="\nRequests: "+JSON.stringify(t),new Error(r+"\n\n"+e.stack)}};i.unformatted={mode:"UNFORMATTED_VALUE",nicknames:["unformatted","values"]},i.formatted={mode:"FORMATTED_VALUE",nicknames:["formatted","texts"]},i.formula={mode:"FORMULA",nicknames:["formula","formulas"]},te.drive=r=>{if(null===r)return null;if(void 0===r)return te.drive.active;if(g.str.id(r))return te.drive(m((()=>DriveApp.getFileById(r)),"DriveApp.getFileById"));if(g.str.url(r))return te.drive(te.drive.urlToId(r));if(g.str(r))return te.drive(te.drive.byPath(r));const a=g.drive(r);if(o(g.obj(r)&&a&&a.mime),r.mr)return r;const s=r.getId();if(DriveApp!==a.creator)return te.drive(DriveApp.getFileById(s));if(te.drive.cache||(te.drive.cache={}),te.drive.cache[s])return te.drive.cache[s];let l={mr:{}},u=r,c=m((()=>a.factory.app.openById(s)),a.factory.name+".openById");switch(H.extend(l,u),H.extend(l,c),H.cacheables(l),l.getMimeType||(l.getMimeType=()=>MimeType.FOLDER,l.mimeType=MimeType.FOLDER),l.type=l.mimeType,l.type){default:n.warn("mr.drive: Unexpected file type: "+l.type);break;case MimeType.FOLDER:H.cacheable(l,"files",(()=>b(u.getFiles(),(e=>te.drive(e.elem))).elems)),H.cacheable(l,"folders",(()=>b(u.getFolders(),(e=>te.drive(e.elem))).elems)),l.get=e=>{const t=g.str(e)&&!!Object.keys(MimeType).filter((t=>t==e)).length?"ByType":"ByName",r=B(l["files"+t](e));return r.length||(r=B(l["folders"+t](e))),r.map((e=>te.drive(e)))};break;case MimeType.GOOGLE_SHEETS:const r=()=>{J.keys(i).forEach((r=>{const n=i[r];H.cacheable(l,[n.mode,...n.nicknames],(()=>(e.reduce(((e,t)=>e+(t[n.mode]||"")),"").slice(0,-1).length&&m((()=>l.read.go(n.mode)),"read.go"),o(t[n.mode],"Must call ss.read([sheets]) first!"))))}))};r();const a=m((()=>c.getSheets()),"getSheets"),s=(e=null)=>(e&&e.mr.headings||m((()=>q(l.sheets).forEach((e=>{o(!e.mr.headings),e.mr.headings=[null,...e.getRange(e.headingRow,1,1,e.lastColumn).getValues()[0]]}))),"ss.readHeadings"),e&&e.mr.headings);H.cacheable(l,"sheets",(()=>{const e={};return a.forEach((t=>{H.cacheables(t),t.mr={},t.uppername=z.upper(t.name),t.shortname=t.abbr=t.camelname=_.camel(t.name),H.cacheable(t,["headingRow","headingsRow"],(()=>t.frozenRows||1)),H.cacheable(t,["ss","parent"],(()=>te.drive(t.getParent()))),H.cacheable(t,"headings",(()=>s(t))),H.cacheable(e,[t.name,t.abbr,t.index-1,t.sheetId,t.uppername],(()=>t)),o((e.length||0)<t.index),e.length=t.index})),e})),H.cacheable(l,"headings",(()=>{const e={};return q(l.sheets).forEach((t=>H.cacheable(e,[t.name,t.abbr,t.uppername],(()=>t.headings)))),e})),l.read=t=>((t||q(l.sheets)).forEach((t=>{const r={orig:""};if(_.has(r.orig,"'"+t.name+"'!"))return n.warn('No need to ss.read(["'+t.name+'"]) twice!');r.orig+="'"+t.name+"'!A1:ZZZ",J.keys(i).forEach((e=>r[i[e].mode]=r.orig)),e.push(r)})),r(),l),l.read.go=(r=i.formula.mode)=>{const a=e.map((e=>e[r]));o(a.length),e.forEach((e=>e[r]=null));const s=i(l.id,a,r,"COLUMNS");return o(s&&s.spreadsheetId==l.id),s.valueRanges.forEach((e=>{const a=function(e){const t={first:{col:{}},last:{col:{}}};return t.address=e.replace(/\$/g,"").trim().toUpperCase(),t.sheet=t.address.has("!")?j(t.address.match(/(.*)\!/)):void 0,t.a1=t.address.replace(t.sheet+"!",""),t.first.a1=j(t.a1.match(/.*?(?=\:|$)/)),t.first.row=j(t.first.a1.match(/([0-9]+)/)),t.first.col.letter=j(t.first.a1.match(/([a-z]*)/i))||"A",t.first.col.number=X(t.first.col.letter).number,t.last.a1=j(t.a1.match(/(\:|$)(.*)/))||t.first.a1,t.last.row=j(t.last.a1.match(/\d*$/)),t.last.col.letter=j(t.last.a1.match(/([a-z]*)/i)),t.last.col.number=X(t.last.col.letter).number,t.addRight=function(){return this.last.col.letter=X(++this.last.col.number).letter,this.last.a1=this.last.col.letter+this.last.row,this.a1=this.first.a1+":"+this.last.a1,this.sheet&&(this.address=this.sheet+"!"+this.a1),this},t.addLeft=function(){return this.first.col.letter=X(--this.first.col.number).letter,this.first.a1=this.first.col.letter+this.first.row,this.a1=this.first.a1+":"+this.last.a1,this.sheet&&(this.address=this.sheet+"!"+this.a1),this},o(t.first.col.number<=t.last.col.number),t}(e.range),s=o(l.sheets[a.sheet]);t[r]||(t[r]={}),t[r][a.sheet]&&n.warn('Reading over "'+s.name+'" sheet data!'),e.values.unshift(null),s.mr.headings=r==i.formula.mode?s.headings:e.values.map((e=>e&&e[s.headingRow-1])),s.mr.headings.forEach(((t,r)=>{if(!t)return;if(!e.values[r])return;const n=s.headingRow+1,i=e.values[r].length;for(let t=0;t<s.headingRow;++t)e.values[r].shift();const a=X(r).letter,l=z.camel(t),o="'"+s.name+"'!$"+a+"$"+n+":$"+a+"$"+i,u="'"+s.name+"'!R"+n+"C"+r+":R"+i+"C"+r;e.values[r].number=r,e.values[r].letter=a,e.values[r].heading=t,e.values[r].abbr=l,e.values[r].address={a1:o,r1c1:u,valueOf:()=>o},e.values[t]=e.values[l]=e.values[a]=e.values[r]})),t[r][s.name]=t[r][s.abbr]=t[r][s.sheetId]=t[r][s.index]=e.values})),t[r]};case MimeType.GOOGLE_FORMS:}return te.drive.cache[s]=l},H.extend(te.drive,DriveApp),H.cacheables(te.drive),te.drive.auth=!0,te.drive.byPath=e=>{const t=(e,t)=>{if(!e)throw new Error("No "+t);n.warn("Multiple "+t)};return te.drive(e.split(/[\\\/]/).reduce(((e,r,n,i)=>"."==r?e:".."==r?B.uno(B(e.getParents()),(r=>t(r.length,"parents found for: "+e.getName()))):n<i.length-1?i.uno(i(e.getFoldersByName(r)),(e=>t(e.length,"folders found with name: "+r))):i.uno(i(e.getFilesByName(r)),(e=>t(e.length,"files found with name: "+r)))),DriveApp.getRootFolder()))},te.drive.utilities=Utilities,te.drive.fileTypes=r("folder","ss","doc","form","site","slide"),te.drive.file=te.drive.File={},te.drive.folder=te.drive.Folder={},H.extend(te.drive.folder,DriveApp.getRootFolder),H.cacheables(te.drive.folder),te.drive.folder.isFileType=!0,te.drive.ss=te.drive.spreadsheet=te.drive.Spreadsheet={},H.extend(te.drive.ss,SpreadsheetApp),H.cacheables(te.drive.ss),te.drive.ss.isFileType=!0,te.drive.sheet=te.drive.Sheet={},H.cacheables(te.drive.sheet,"active",(()=>te.drive.ss.activeSheet)),te.drive.doc=te.drive.document=te.drive.Document={},H.extend(te.drive.doc,DocumentApp),H.cacheables(te.drive.doc),te.drive.doc.active=te.drive.doc.activeDocument,te.drive.doc.isFileType=!0,te.drive.form=te.drive.Form={},H.extend(te.drive.form,FormApp),H.cacheables(te.drive.form),te.drive.form.active=te.drive.form.activeForm,te.drive.form.isFileType=!0,te.drive.slide=te.drive.presentation=te.drive.Slide=te.drive.Presentation={},H.extend(te.drive.slide,SlidesApp),H.cacheables(te.drive.slide),te.drive.slide.active=te.drive.slide.activePresentation,te.drive.slide.isFileType=!0,te.drive.site=te.drive.Site={},H.extend(te.drive.site,SitesApp),H.cacheables(te.drive.site),te.drive.site.active=te.drive.site.activeSite,te.drive.site.isFileType=!0,te.drive.page=te.drive.Page={},te.drive.page.active=te.drive.site.activePage,H.cacheable(te.drive,"active",(()=>D(b(te.drive.types,(e=>te.drive[+e].active)).elems))),H.cacheable(te.drive,"files",(()=>b(te.drive.files,(e=>te.drive(e.elem))).elems)),H.cacheable(te.drive,"folders",(()=>b(te.drive.folders,(e=>te.drive(e.elem))).elems)),H.cacheable(te.drive,"items",(()=>te.drive.folders.concat(te.drive.files))),H.cacheable(te.drive,"trashed",(()=>{const e=b(te.drive.trashFolders,(e=>te.drive(e.elem))).elems,t=b(te.drive.trashFiles,(e=>te.drive(e.elem))).elems,r=e.concat(t);return r.files=t,r.folders=e,r})),te.drive.prop=function(e,t,r="Document"){return o(Object.keys(te.drive.prop.types).filter((e=>e==r)).length),te.drive.auth?d((function(){const n="get"+_.title(r)+"Properties";var i=PropertiesService[n]();return o(i),g.undefNull(e)?i.getProperties():g.undefined(t)?i.getProperty(e):t?i.setProperty(e,t):i.deleteProperty(e)})):null},H.cacheable(te.drive,"props",te.drive.prop),te.drive.prop.types=r("DOCUMENT","USER","SCRIPT")}r("UNKNOWN","UNDEF","NULL","ERROR","NUM","NAN","INF","BOOL","STR","ARR","FUNC","OBJ","DATE","DT","DUR","INTERVAL","SS","SHEET","DOC","FORM","SLIDE","FOLDER","FILE");const ne=r("DEBUG","RELEASE"),ie=r("ADDON","WEBAPP","TRIGGER","TEST","UNKNOWN"),ae=ne.DEBUG,se={time:luxon.DateTime.local(),type:ie.UNKNOWN};n.useConsole=!0,n.useLogger=!1;const le=e=>o();return Object.defineProperties(e,{name:{get:()=>"mr",set:le},license:{get:()=>t,set:le},version:{get:()=>"1.0.0",set:le},lang:{get:()=>"en-us",set:le},callstack:{get:()=>h().display,set:le},caller:{get:()=>h()[1].func,set:le},file:{get:()=>h()[1].file,set:le},line:{get:()=>h()[1].line,set:le},column:{get:()=>h()[1].column,set:le},entry:{get:()=>se,set:le},now:{get:Z,set:le},extendPrototypes:{value:function(){Object.defineProperties(Number.prototype,{format:{configurable:!0,value:function(){return I.toString.apply(this,[this,...arguments])}},clamp:{configurable:!0,value:function(){return I.clamp.apply(this,[this,...arguments])}},normal:{configurable:!0,value:function(){return I.dist.norm.apply(this,[this,...arguments])}}}),Number.prototype.norm=Number.prototype.gaussian=Number.prototype.bell=Number.prototype.normal,Object.defineProperties(String.prototype,{left:{configurable:!0,value:function(){return _.left.apply(this,[this,...arguments])}},right:{configurable:!0,value:function(){return _.right.apply(this,[this,...arguments])}},mid:{configurable:!0,value:function(){return _.mid.apply(this,[this,...arguments])}},insert:{configurable:!0,value:function(){return _.insert.apply(this,[this,...arguments])}},count:{configurable:!0,value:function(){return _.count.apply(this,[this,...arguments])}},findClosing:{configurable:!0,value:function(){return _.findClosing.apply(this,[this,...arguments])}},has:{configurable:!0,value:function(){return _.has.apply(this,[this,...arguments])}},lower:{configurable:!0,get:function(){return _.lower(this)}},upper:{configurable:!0,get:function(){return _.upper(this)}},camel:{configurable:!0,get:function(){return _.camel(this)}},snake:{configurable:!0,get:function(){return _.snake(this)}},kebab:{configurable:!0,get:function(){return _.kebab(this)}},pascal:{configurable:!0,get:function(){return _.pascal(this)}},hash:{configurable:!0,get:function(){return _.hash(this)}},nonblank:{configurable:!0,get:function(){return _.nonblank(this)}}}),Object.defineProperties(Array.prototype,{loop:{configurable:!0,value:function(){return b.apply(this,[this,...arguments])}},match:{configurable:!0,value:function(){return B.match.apply(this,[this,...arguments])}},uno:{configurable:!0,get:function(){return D(this)}}}),Object.defineProperties(Object.prototype,{clear:{configurable:!0,value:function(){return N.apply(this,[this,...arguments])}},union:{configurable:!0,value:function(){return R.apply(this,[this,...arguments])}},intersect:{configurable:!0,value:function(){return C.apply(this,[this,...arguments])}},subtract:{configurable:!0,value:function(){return L.apply(this,[this,...arguments])}},loop:{configurable:!0,value:function(){return b.apply(this,[this,...arguments])}}}),Object.defineProperties(Object.prototype.loop,{continue:{get:()=>{throw y}},break:{get:()=>{throw F}}})}},retry:{value:d},poll:{value:(e,{period:t=mr.minToMs(1),wait:r=mr.secToMs(1),thisArg:n}={})=>{for(let i=luxon.DateTime.local();;){const a=e.call(n);if(a)return a;if(t<K(i).milliseconds)return 0;if(drive.account.quotas.runtime.limited())return null;c(r)}}},profile:{value:m},loop:{value:b},iterate:{value:b},break:{get:()=>b.break},continue:{get:()=>b.continue},filter:{get:()=>b.continue},log:{value:n},is:{value:g},swap:{value:v},clone:{value:x},deepCopy:{value:x},clear:{value:N},empty:{value:N},union:{value:R},intersection:{value:C},intersect:{value:C},subtraction:{value:L},subtract:{value:L},diff:{value:L},expectation:{value:O},expect:{value:O},uno:{value:D},randomIndex:{value:T},shuffle:{value:w},randomize:{value:w},sample:{value:(e,t=1,r)=>{const n=g.obj(e)?Object.values(e):B(e);return o(t<=n.length),b(T(n,t,r),(e=>n[e.elem])).elems}},cartesian:{value:A},mux:{value:S},multiplex:{value:S},dot:{value:(e,t)=>{o(g(e)===g(t));const r=g.obj(e),n=r?Object.values(e):B(e),i=r?Object.values(t):B(t);return b(b(n,(e=>e.elem*i[+e])).elems,(e=>e.accum+e.elem),{initial:0}).elems}},cross:{value:(e,t)=>{o(g(e)===g(t));const r=g.obj(e),n=r?Object.values(e):B(e),i=r?Object.values(t):B(t);return o(n.length===i.length),b(n,(e=>{const t=(e+1)%n.length,r=(i.length+e)%i.length;return n[t]*i[r]-n[r]*i[t]})).elems}},boolean:{value:P},bool:{value:P},numbers:{value:U},number:{value:I},num:{value:I},string:{value:_},str:{value:_},array:{value:B},arr:{value:B},object:{value:J},obj:{value:J},enum:{value:r},hourToMs:{value:e=>60*e*60*1e3},minToMs:{value:e=>60*e*1e3},secToMs:{value:e=>1e3*e},serialNumber:{value:V},serial:{value:V},date:{value:Z},duration:{value:K},client:{value:re},server:{value:te}}),e}
