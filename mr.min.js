function mrInit(e){"use strict";e||(e=globalThis),HtmlService=e.HtmlService;const t=we("AKfycbyn2rf6Uk2aIL-ViBd81431n8XhwKe8M6pHZA70clG-ej3r97bkTdBV6Ehhzu-e1L6R"),n="A".charCodeAt(0),r=" ".repeat(4),o=1e3,i=e=>e*o,a=6e4,s=e=>e*a,c=36e5,l=864e5,p=3600,u=86400,g=1440,d=Symbol("TIMESUP"),m=(Symbol("PRIVATE"),Symbol("PUBLIC")),h={name:"CONTINUE"},f={name:"BREAK"},y={name:"EMPTY"};Object.defineProperties(e,{CONTINUE:{get:()=>{throw h}},BREAK:{get:()=>{throw f}},EMPTY:{get:()=>{throw y}}});const w={},b={};w.Debug=!0,b.Debug=!0,w.Release=!1,b.Release=!1,w.useBatchGet=!1,b.useBatchGet=!1,w.warnMemoizeRedefine=!1,b.warnRedefinitions=!0,w.reset=()=>Object.keys(b).forEach((e=>w[e]=b[e])),Number=e.Number,BigInt=e.BigInt,Boolean=e.Boolean,String=e.String,Symbol=e.Symbol,Date=e.Date,Set=e.Set,WeakSet=e.WeakSet,Map=e.Map,WeakMap=e.WeakMap,Function=e.Function,Array=e.Array,Object=e.Object,Error=e.Error,EvalError=e.EvalError,TypeError=e.TypeError,RangeError=e.RangeError,SyntaxError=e.SyntaxError,ReferenceError=e.ReferenceError,URIError=e.URIError;const S=e=>e&&e.constructor(e),v=e=>Number.parseInt(e),E=e=>I.Finite(e)?Number(e):void 0,T=e=>Object.entries(e),A=e=>!e||I(e,Array)?e:T(e).filter((([e])=>I(e,Number))),O=e=>"object"==typeof e?void 0:Object.keys({[e]:null})[0],R=/[-\w]{25,}/,k=/\d{19}/,D=/[^\\\/]+/g,I=(e,...t)=>t.every((t=>{switch(t){default:return I.NaN(t)?I.NaN(e):t&&RegExp===t.constructor?I(e,String)&&t.test(e):t&&Object===t.constructor?Object.values(t).includes(e):e instanceof t||e===t;case P(e):return!0;case S:return e!==Object(e);case v:return Number.isSafeInteger(1*e);case 1/0:return 1/0===e||-1/0===e;case E:return I.Finite(e);case T:return I(e,Array)&&e.every((e=>2==e.length&&I(e[0],O)));case A:return Array.init(e.length).every((t=>e.hasOwnProperty(t)));case O:return I(e,Symbol)||I(e,String)||I(e,Number)}}));I.NaN=e=>"number"==typeof e&&Number(e)!=Number(e),I.Finite=e=>"bigint"==typeof e||Number.isFinite(e);const P=function(t){if(z(1==arguments.length),null==t)return t;const n=e[t.constructor.name];if(Object!==n)return n;return[...L].map((e=>e(t))).filter((e=>e)).uno||Object};P.register=e=>L.add(e);const L=new Set,j=function(e){if(!new.target)return new j(e);if(I(e,j))return e;const t=I(e,Date)?e:null==e?new Date:new Date(e);this.value=((t.getTime()-C.getTime())/6e4-t.getTimezoneOffset())/1440,Object.defineProperty(this,"valueOf",{value:function(){return this.value}}),this.toDate=function(){const e=Math.floor(this.value),t=this.value-e,n=Math.round(24*t*60*60*1e3),r=new Date(Date.UTC(1899,11,30+e)+n);return r.setMinutes(r.getMinutes()+r.getTimezoneOffset()),r}},C=new Date(Date.UTC(1899,11,30,0,0,0,0)),F=(e,t,n)=>e.hasOwnProperty(t)?e[t]:e[t]=n,$=eval,N=(e,t=r)=>{const n=[];return JSON.stringify(e,((e,t)=>I(t,S)?t:I(t,Function)?t.toString():n.includes(t)?`↺{${t&&Object.keys(t)}}`:(n.push(t),t)),t)},B=e=>N(e).replace(/\n/g,"").replace(/\s+/g," "),x=e=>e.filter((e=>!0)),U=(...e)=>{const t=e.flat(),n=t&&t.constructor===Array?t.reduce(((e,t)=>Object.assign(e,{[t]:t})),{}):t,r={validate:{value:e=>Object.values(n).includes(e)}},o=Object.fromEntries(T(n).map((([e,t])=>[e,{enumerate:!0,value:t}])));return Object.defineProperties(n,Object.assign(o,r))},G=(e,t=10,n=87)=>{var r="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~!@#$%^*-_=+,.?/|:;()[]{}❤♻⚜⚠©®™⚙⎈★☇☈☉☊☋☌☍☏☐☒☖☗☙☚☛☜☞☟☡☤☥☧☨☩☫☬☭☰☱☲☳☴☵☶☷☻☼☽☾☿♁♃♄♅♆♇♔♕♖♗♘♙♚♛♜♝♞♡♢♤♧♩♪♫♬♭♮♯♰♱♲♳♴♵♶♷♸♹♺♼♽⚀⚁⚂⚃⚄⚅⚐⚑⚘⚚⚝⚞⚟⚢⚣⚤⚥⚦⚨⚩⚬⚭⚮⚯⚲⚳⚴⚵⚶⚷⚸⚹⚺⚻⚼⚿⛀⛁⛂⛃⛆⛇⛉⛊⛋⛌⛍⛐⛒⛕⛖⛗⛘⛙⛚⛛⛜⛝⛞⛟⛠⛡⛢⛣⛤⛥⛦⛧⛨⛫⛬⛭⛮⛯⛶⛻⛼⛾⛿✀✁✃✄✎✐✑❥❦❧".split("");r.length<=n&&(n=r.length-1);for(var o=r.slice(0,t),i=r.slice(0,n),a=(""+e).split("").reverse().reduce((function(e,n,r){if(o.indexOf(n)<0)throw new Error("Invalid digit `"+n+"` for base "+t+".");return e+o.indexOf(n)*Math.pow(t,r)}),0),s="";0<a;)s=i[a%n]+s,a=(a-a%n)/n;return s.includes("NaN")&&console.error(`NaN detected: encode(${e}, ${t}, ${n}) → ${s}`),s||"0"};G.max4=54e6;const H=e=>{throw e};function z(e,t=new Error("❌ assert failed")){return e||w.Release?e:H(t)}const _=({start:e,end:t,name:n=""}={})=>{const r=ae.now();return(t=t||r)<(e=e||W[n]||r)&&([e,t]=[t,e]),z(I(e,ae)&&I(t,ae)),W[n]=r,se.fromDateTimes(e,t).toDuration()},W={},J=(e,...t)=>(...n)=>e.apply(e,[...t,...n]),V=(e,...t)=>{const n=t[0];return X&&X.getRange&&ee((()=>X.getRange(Z++,1,1,2+t.length+2).setValues([[(new j).value,e,K.trim(),...t,Q.trim()]]))),console[e].apply(null,[...null==K?[]:[K],...t,...null==Q?[]:[Q]]),n},q=J(V,"log");q.info=J(V,"info"),q.warn=J(V,"warn"),q.error=J(V,"error"),q.time=J(V,"time"),q.timeEnd=J(V,"timeEnd");let K,Q,X,Z=1;q.configure=({pre:e="",post:t="",sheet:n,shouldClearSheet:r=!1}={})=>{if(K=e,Q=t,X=n,!n||!n.getRange)return;const o=ee((()=>n.getFrozenRows())),i=ee((()=>n.getLastRow()));r&&n.getRange(`${1+o}:${(i||1)-(o||1)+1}`).clearContent(),Z=1+Math.max(o,r?o||1:i||1)};const Y=(e,{attempts:t=1,escalation:n=0,milliseconds:r=100}={})=>{let o=1;for(;0<t--;)try{return"function"==typeof e?e():e}catch(e){if(!(0<t))return e;i=o*r,z(Utilities&&I(Utilities.sleep,Function)),q(`Sleeping for ${i}ms`),Utilities.sleep(i),o+=n}var i},ee=(e,t)=>{const n=Y(e,{...t,escalation:1,attempts:4});return I(n,Error)?H(n):n},te=[],ne=()=>{try{throw new Error("🦎")}catch(e){const t=e.stack.replace(/^.*🦎\n/,"").replace(/\n\s+at __GS_INTERNAL_top_function_call__.gs:1:8/,"");let n=t.split(/\s*at /g);return n.shift(),n.shift(),n=n.map((e=>({func:e.includes("(")?e.match(/\S+/).pop():"(anonymous)",file:e.includes("(")?e.match(/\((.+?)[:)]/).pop():e.match(/[^:]+/).pop(),line:1*e.match(/:(\d+):/).pop(),column:1*e.match(/:(\d+)(?:\)|$)/).pop()}))),n.display=t,n}},re=e=>String.fromCharCode(e),oe=e=>(z(0<e)&&e<=26?"":re(n+(e-1-26)/26))+re(n+(e-1)%26),ie=(e=.2*fe.GASQuotaRuntime)=>fe.GASQuotaRuntime<Math.max(1e3,1.2*e)+_({start:he}).as("ms");if(!luxonInit)throw new ReferenceError("Missing dependency: luxon");const{DateTime:ae,Interval:se}=luxonInit({});if(!PropertiesService)throw new ReferenceError("Missing dependency: PropertiesService");const ce=Object.defineProperties({},{file:{get:()=>ee((()=>PropertiesService.getDocumentProperties())),enumerable:!0},script:{get:()=>ee((()=>PropertiesService.getScriptProperties())),enumerable:!0},user:{get:()=>ee((()=>PropertiesService.getUserProperties())),enumerable:!0}});if(!CacheService)throw new ReferenceError("Missing dependency: CacheService");const le=Object.defineProperties({},{file:{get:()=>ee((()=>CacheService.getDocumentCache())),enumerable:!0},script:{get:()=>ee((()=>CacheService.getScriptCache())),enumerable:!0},user:{get:()=>ee((()=>CacheService.getUserCache())),enumerable:!0}});if(!LockService)throw new ReferenceError("Missing dependency: LockService");const pe=Object.defineProperties({},["Document","Script","User"].reduce(((e,t)=>Object.assign(e,{[t]:{get:()=>{const e=new Date,n=ee((()=>LockService[`get${t}Lock`]()));return n?Object.assign(n,{criticalSection:r=>{for(let r=!1;!r;){if(z(!ie()),ie())return ee((()=>n.releaseLock())),q.error(`Times up for Lock.${t} after ${_({beginTryLock:e}).as("ms")}ms`),d;r=ee((()=>n.tryLock(i(10))))}z(ee((()=>n.hasLock()))),q(`Lock.${t} obtained in ${_({beginTryLock:e}).as("ms")}ms`);const o=new Date,a=Y((()=>r()));return ee((()=>n.releaseLock())),q(`Lock.${t} was retained for ${_({beginHasLock:o}).as("ms")}ms`),I(a,Error)?H(a):a}}):null}}})),{}));if(!ScriptApp)throw new ReferenceError("Missing dependency: ScriptApp");const ue=Object.defineProperties({},{project:{get:()=>ee((()=>ScriptApp.getProjectTriggers()))},script:{get:()=>ee((()=>ScriptApp.getScriptTriggers()))}}),ge=Y((()=>Object.keys(globalThis).map((e=>"App"==e.slice(-3)&&I(globalThis[e].getUi,Function)?ee((()=>globalThis[e].getUi())):0)).filter((e=>0!==e)).uno)),de={webappBackend:{GASQuotaRuntime:s(30),name:"☁"},webappFrontend:{GASQuotaRuntime:s(30),name:"💧"},macro:{GASQuotaRuntime:s(6),name:"MACRO"},trigger:{GASQuotaRuntime:s(6),name:"TRIGGER"}},me=e=>fe=e,he=ae.now();let fe;const ye="mr.js ™© "+he.year+" Michael Wilford. All Rights Reserved.";function we(e){return`https://script.google.com/macros/s/${e}/exec?scriptid=${e}`}const be=[],Se=e=>{z(e.name&&e.notifier),be.some((t=>t.name==e.name))||be.push(e)},ve=(e,t)=>{const n=ae.now().valueOf();(e?be.filter((t=>e==t.name&&!t.notified)):be).forEach((e=>{e.old.equals(t)||(e.new=t,e.notified=n,e.notifier(e),e.old=t)}))},Ee=Object.keys(ce).reduce(((e,t)=>(e[t]=(e,n)=>{const r=ce[t];return null===e?ve()&&ee((()=>r.deleteAllProperties())):void 0===e?ee((()=>r.getProperties())).map((e=>JSON.parse(e))):void 0===n?JSON.parse(ee((()=>r.getProperty(e)))):null===n?ve(e)&&ee((()=>r.deleteProperty(e))):(ve(e,n),ee((()=>r.setProperty(e,B(n)))))},e)),{}),Te=Object.keys(le).reduce(((e,t)=>(e[t]=(e,n)=>{const r=le[t],[o,i]=I(e,Array)?["getAll","removeAll"]:["get","remove"];return I(e,Object)?ee((()=>r.putAll(e,21600))):void 0===n?JSON.parse(ee((()=>r[o](e)))):ee(null===n?()=>r[i](e):()=>r.put(e,B(n),21600))},e)),{}),Ae=Object.keys(ue).reduce(((e,t)=>(e[t]=(...e)=>{ue[t].getScriptTriggers().filter((t=>e.every((e=>I(e,ScriptApp.TriggerSource)?e==ee((()=>t.getTriggerSource())):I(e,ScriptApp.EventType)?e==ee((()=>t.getEventType())):I(e.toString(),k)?e==ee((()=>t.getUniqueId())):I(e.toString(),R)?e==ee((()=>t.getTriggerSourceId())):z(I(e,String))&&e==ee((()=>t.getHandlerFunction())))))).forEach((e=>e.delete=()=>ee((()=>ScriptApp.deleteTrigger(e)))))},e)),{});DriveApp.getItemById=e=>{const t=ee((()=>DriveApp.getFileById(e)));switch(ee((()=>t.getMimeType()))){default:return t;case MimeType.FOLDER:return ee((()=>DriveApp.getFolderById(e)));case MimeType.GOOGLE_DOCS:return ee((()=>DocumentApp.openById(e)));case MimeType.GOOGLE_FORMS:return ee((()=>FormApp.openById(e)));case MimeType.GOOGLE_SHEETS:return ee((()=>SpreadsheetApp.openById(e)));case MimeType.GOOGLE_SLIDES:return ee((()=>SlidesApp.openById(e)))}},DriveApp.getItemByUrl=e=>DriveApp.getItemById(e.match(R).pop()),DriveApp.getIdFromPath=e=>e.match(D).reduce(((e,t,n,r)=>ee((()=>e[`get${n==r.length-1?"Files":"Folders"}ByName`](t))).asArray().uno),ee((()=>DriveApp.getRootFolder()))),DriveApp.getItemByPath=e=>DriveApp.getItemById(DriveApp.getIdFromPath(e)),DriveApp.getItem=e=>I(e,D)?DriveApp.getItemByPath(e):DriveApp.getItemById(e.match(R).pop());const Oe={},Re=Array(702).fill(0).reduce(((e,t,n)=>{const[r,o]=[1+n,oe(1+n)];return e[r]=Symbol(r),e[o]=Symbol(o),e}),{}),ke=U(["background","backgrounds","backgroundObject","backgroundObjects","dataValidation","dataValidations","fontColorObject","fontColorObjects","fontFamily","fontFamilies","fontLine","fontLines","fontSize","fontSizes","fontStyle","fontStyles","fontWeight","fontWeights","formula","formulas","formulaR1C1","formulasR1C1","horizontalAlignment","horizontalAlignments","note","notes","numberFormat","numberFormats","richTextValue","richTextValues","textDirection","textDirections","textRotation","textRotations","textStyle","textStyles","value","values","verticalAlignment","verticalAlignments","wrapStrategies","wrapStrategy","wrap","wraps"]),De=({spreadsheet:e=SpreadsheetApp.getActive(),sheets:t="ALL",dataTypes:n=[ke.values],ignoreCache:r=!1}={})=>{I(e,R)&&(e=SpreadsheetApp.openById(e)),t=I(t,Array)?t.map((t=>I(t,String)?e.getSheetByName(t):t)):e.getSheets();const o=e.getId();Sheets&&w.useBatchGet&&q.warn("batchGet not yet implemented");const i=n.reduce(((n,i)=>(n[i]=t.map((t=>{const n=t.getName(),a=F(F(Oe,o,{}),i,{});if(!r&&a[n])return a[n];const s=Math.max(1,t.getFrozenRows()),c=i[0].toUpperCase()+i.slice(1),[l,p]=["get"+c,"set"+c],u=n.toCamelCase();let g=t.getDataRange()[l]();const d=g.slice(0,s).reverse().transpose().map((e=>e.filter((e=>e))[0]||""));return g.splice(0,s),g.unshiftEmpty(1+s),g=a[n]=g.transpose(),g.unshiftEmpty(),g.forEach(((r,o)=>{r.number=o,r.letter=oe(r.number),r.heading=d[o-1].toString(),r.name=r.heading.toCamelCase(),r.headingRow=s,r.dataType=i,r.table=g,r.sheet=t,r.spreadsheet=e,r.getRange=()=>t.getRange(s+1,1,r.length-s-1,1),r.write=(e=void 0)=>r.getRange()[p](I(e,void 0)?r.nonempty().map((e=>[e])):e),g[r.name]&&q.warn(`Duplicate column headings found: '${n}'!'${r.heading}'`),g[r.name]=g[Re[r.letter]]=g[Re[r.number]]=r})),g[m]={name:u,sheet:t,spreadsheet:e},g[m].getRange=()=>t.getRange(s+1,1,t.getLastRow()-s,t.getLastColumn()),g[m].write=(e=void 0)=>g[m].getRange()[p](I(e,void 0)?g.nonempty().transpose().nonempty():e),g})),n[i].forEach((e=>n[i][e[m].name]=e)),n[i][m]={spreadsheet:e},n)),{});return i.spreadsheet=e,i};const Ie=[],Pe={getChanges:()=>Ie.filter((e=>e.old!=e.new)),create:e=>{const t=e=>Ie.filter((t=>t.name==e.name)).uno.new=e.new,n=Ee.script();e.forEach((e=>{const r=e.match(/^([^\.=$ ]+)/).pop(),o=ke[r]||"prop",i=e.match(/^([^=$ ]+)/).pop();if("prop"==o){const r=n[i];Se({name:i,notifier:t,old:r}),Ie.some((e=>e.name==i))||Ie.push({desc:e,name:i,type:o,old:r})}else{e.count(".");const[t,n,r,a]=e.match(/[^ =]+/).pop().split("."),s=De({spreadsheet:ss,sheets:"ALL",dataTypes:[n]})[n][r][a];Ie.some((e=>e.name==i))||Ie.push({desc:e,name:i,type:o,old:s})}}))}},Le=Session&&ee((()=>Session.getActiveUser().getEmail())),je=ScriptApp&&ee((()=>ScriptApp.getService().getUrl())),Ce=G(he%G.max4);function Me({time:e=he,who:n=Le,id:r="DEBUG",request:o}={}){const i={method:"post",contentType:"application/json",headers:{Authorization:"Bearer "+ee((()=>ScriptApp.getOAuthToken()))},muteHttpExceptions:!0,payload:B(arguments[0])},a=ee((()=>UrlFetchApp.fetch(t,i))),s=a.getResponseCode();return z(200<=s&&s<300,new Error("Response code: "+s)),JSON.parse(a.getContentText())}let Fe=null;function $e({widgets:e}={}){if(!new.target)return new $e(arguments[0]);this.config={...arguments[0]||{}},this.config.tree=this,this.config.widgets=(this.config.widgets||[]).map((e=>new Ne({...this.config,...e}))),this.args={...this.config},delete this.args.tree,delete this.args.widgets}function Ne({tree:e,name:t,title:n,type:r,img:o,menu:i=!0,request:a}={}){if(!new.target)return new Ne(arguments[0]);this.config={...arguments[0]||{}},this.args={...this.config},delete this.args.tree,delete this.args.widgets}$e.prototype.getPage=function(e){return this.config.widgets.filter((t=>t&&"page"==t.config.type&&null!=e[t.config.name]))[0]||this.config.widgets[0]},Ne.prototype.go=function(e){q("Widget.go: "+this.config.name);const t=HtmlService.createTemplateFromFile(this.config.name),n={...this.args,id:Ce,time:he,who:Le,...e};if(this.response=this.config.request&&Me(n),t.data=Fe={...this.config,...n,response:this.response},this.response&&this.response.isError)throw new Error(`\n\nServer:\n\n${this.response.stack}\n\nClient:`);const r=Y((()=>t.evaluate()));if(!r)throw new Error("Failed to evaluate file: "+this.config.name);if(r instanceof Error)throw r;if(null!=r.switchPage)return q('🔀 Switching page from "'+this.config.name+'" to "'+r.switchPage+'"'),this.config.tree.config.widgets.filter((e=>r.switchPage==e.config.name))[0](n);const o=this.config.title||(q.warn(`Page "${this.config.name}" will use the default title.`),"App"),i=this.config.favicon||(q.warn(`Page "${this.config.name}" will use the default favicon.`),"https://cdn-icons-png.flaticon.com/512/148/148905.png"),a=r.setFaviconUrl(i).setTitle(o).addMetaTag("viewport","width=device-width, initial-scale=1").setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);return q("✅ "+this.config.name),a};const Be={},xe={select:e=>[...document.querySelectorAll(e)],comments:(e=document.body)=>document.createNodeIterator(e,NodeFilter.SHOW_COMMENT,(()=>NodeFilter.FILTER_ACCEPT),!1).asArray(),data:(e,t)=>JSON.parse(e.getAttribute("data-"+t)),call:(e,t)=>xe.select(e).forEach((e=>{const n=e.getAttribute("data-"+t.name),r=n&&Be[n];if(I(r,Function))return r(t)})),events:["oncopy","oncut","onpaste","onabort","onblur","onfocus","onauxclick","onbeforeinput","oncanplay","oncanplaythrough","onchange","onclick","onclose","oncontextmenu","oncuechange","ondblclick","ondrag","ondragend","ondragenter","ondragexit","ondragleave","ondragover","ondragstart","ondrop","ondurationchange","onemptied","onended","onformdata","oninput","oninvalid","onkeydown","onkeypress","onkeyup","onload","onloadeddata","onloadedmetadata","onloadend","onloadstart","onmousedown","onmouseenter","onmouseleave","onmousemove","onmouseout","onmouseover","onmouseup","onwheel","onpause","onplay","onplaying","onprogress","onratechange","onreset","onresize","onscroll","onsecuritypolicyviolation","onseeked","onseeking","onselect","onslotchange","onstalled","onsubmit","onsuspend","ontimeupdate","onvolumechange","onwaiting","onselectstart","onselectionchange","ontoggle","onpointercancel","onpointerdown","onpointerup","onpointermove","onpointerout","onpointerover","onpointerenter","onpointerleave","ongotpointercapture","onlostpointercapture","onmozfullscreenchange","onmozfullscreenerror","onanimationcancel","onanimationend","onanimationiteration","onanimationstart","ontransitioncancel","ontransitionend","ontransitionrun","ontransitionstart","onwebkitanimationend","onwebkitanimationiteration","onwebkitanimationstart","onwebkittransitionend","onerror","onfullscreenchange","onfullscreenerror"]},Ue=U({karos:".karos",jobsList:".karosJobsList"}),Ge=[],He={get:e=>e?e.map((e=>z(Ge.filter((t=>e==t.created)).uno))):Ge,add:e=>{Ge.push(e),z(Ge.length==[...new Set(Ge.map((e=>e.created)))].length),xe.select(Ue.jobsList).forEach((t=>{const n=z(xe.data(t,new Error("addJob")));z(window[n])(e)}))},done:e=>{z(Ge.length==[...new Set(Ge.map((e=>e.created)))].length);const t=Ge.findIndex((t=>t.created==e.created));z(Ge.splice(t,1)==e.created),xe.select(Ue.jobsList).forEach((t=>{const n=z(xe.data(t,new Error("jobDone")));z(window[n])(e)}))}},ze=()=>setTimeout((()=>_e([{}])),Ge.length?250:4137),_e=e=>{e.forEach((e=>{let t=ae.now().valueOf();for(;Ge.some((e=>e.created==t));)++t;e.created=t,He.add(e)}));google.script.run.withFailureHandler((e=>{q.error(`❌ createKarosJobs failed: ${N(e)})`);const t=JSON.parse(e.message.match(/«jobs:(.+)»/).pop());Ge.filter((e=>t.includes(e.created))).forEach((t=>{if(I(t.onFailure,Function))return t(t,e);q.warn("Missing job.onFailure which is needed to re-add the job.")}))})).withSuccessHandler((e=>{(e=e.map((e=>z(Ge.filter((t=>t.created==e.created)).uno)))).forEach((e=>{if(e.worker,He.jobDone(e),I(e.onSuccess,Function))return e.onSuccess(e);q.warn("Missing job.onSuccess")})),ze()})).request(e)};return globalThis.window&&globalThis.window.addEventListener("DOMContentLoaded",(e=>{M&&M.AutoInit(),xe.select(".collapsible.expandable").forEach((e=>M.Collapsible.init(e,{accordion:!1}))),xe.select(Ue.jobsList).forEach((e=>{const t=z(xe.data(e,new Error("getJobs")));z(window[t])().forEach((e=>Ge.push(e)))})),ze(),xe.select(".karos").forEach((e=>{const t=e.data(e,"onClick"),n=t&&Be[t];I(n,Function)&&(e.onclick=n)})),xe.call(Ue.karos,{name:"onLoadDone"})})),Object.assign(e,{Settings:w,EntryType:de,setEntryType:me,now:he,License:ye,Version:"0.1.0",asciiA:n,nbsp:" ",nbtab:r,Serial:j,DateTime:ae,Duration:_,Interval:se,msPerSec:o,msPerMin:a,msPerHr:c,msPerDay:l,secPerMin:60,secPerHr:p,secPerDay:u,minPerHr:60,minPerDay:g,hrPerDay:24,msToSec:e=>e/o,msToMin:e=>e/a,msToHr:e=>e/c,msToDay:e=>e/l,secToMin:e=>e/60,secToHr:e=>e/p,secToDay:e=>e/u,minToHr:e=>e/60,minToDay:e=>e/g,hrToDay:e=>e/24,secToMs:i,minToMs:s,hrToMs:e=>e*c,dayToMs:e=>e*l,minToSec:e=>60*e,hrToSec:e=>e*p,dayToSec:e=>e*u,hrToMin:e=>60*e,dayToMin:e=>e*g,dayToHr:e=>24*e,getCallstack:ne,PUBLIC:m,Column:Re,Primitive:S,SmallInt:v,Finite:E,Entries:T,Indexed:A,Key:O,$TriggerId:k,$Id:R,$Url:/^(?:(?:https?|ftp|smtp):\/\/)?.+$/i,$Path:D,$Email:/^[^\s\@]+@[^\s\@]+\.[^\s\@]+$/,$Range:/^\$?(?:[a-z]+|[0-9]+|[a-z]+\$?[0-9]+)(?::\$?(?:[a-z]+|[0-9]+|[a-z]+\$?[0-9]+))?$/i,toCamelCase:e=>e.toLowerCase().replace(/[^a-zA-Z0-9 ]/g,"").trim().replace(/(?:^\w|[A-Z]|\b\w)/g,((e,t)=>t?e.toUpperCase():e.toLowerCase())).replace(/\s+/g,""),uno:e=>{const t=Object.values(e).filter((e=>void 0!==e));return z(t.length<=1,new Error("❌ uno: Multiple elements found!")),t[0]},nonempty:x,transpose:e=>x(e)[0].map(((t,n)=>e.map((e=>e[n])))),Trigger:ue,Property:ce,Cache:le,Lock:pe,UI:ge,getScriptUrl:we,prop:Ee,cache:Te,trigger:Ae,states:Pe,getTables:De,evalIndirect:$,stringify:N,minify:B,escapeRegex:e=>e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),is:I,type:P,error:H,assert:z,partial:J,retry:Y,retryGoogle:ee,profile:(e,{desc:t,shouldLog:n=!0,thisArg:r}={})=>{if(!t){const e=ne()[1];t=e.func+" ("+e.file+":"+e.line+")"}te.push(t);const o=te.reduce(((e,t,n)=>e+" » "+t),""),i=ae.now(),a=e.call(r);te.pop();const s=_({start:i});return n&&q("⏱ PROFILE: "+s.as("ms")+"ms to complete"+o),{result:a,duration:s}},log:q,encode:G,itoa:re,atoi:e=>e.charCodeAt(0),columnNumberToLetter:oe,tableToObjects:(e,{replacer:t=null,trimEmpty:n=!0}={})=>e.map(((n,r)=>n.reduce(((n,o,i)=>{const a=e[0][i].valueOf(),s=r&&"function"==typeof t?t(r,a,e[r][i]):e[r][i];return s||0===s?{...n,[a]:s}:n}),{}))).slice(1),id:Ce,url:je,user:Le,backendRequest:Me,include:e=>(Fe?Object.assign(HtmlService.createTemplateFromFile(e),{data:Fe}).evaluate():HtmlService.createHtmlOutputFromFile(e)).getContent(),switchPage:e=>H({switchPage:e}),WidgetTree:$e,Widget:Ne,karosDomClasses:Ue})}